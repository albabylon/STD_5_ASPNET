Жизненный цикл запросов, компоненты Middleware

Поскольку большинство веб-приложений работают по протоколу HTTP, всё, что происходит внутри, сводится к обработке запроса

Что происходит далее после получения запроса в самом приложении, на каждом этапе?
Происходит последовательное прохождение запроса через все подключенные компоненты (или middleware — ПО промежуточного слоя). 
Совокупность таких компонентов и называется конвейером.

Соответственно, первый компонент, получивший запрос, передаёт его по цепочке дальше (похоже на паттерн цепочка обязаностей)
Подключаются компоненты Middleware в методе Configure из класса Startup


!!Конвейер запросов
Каждый компонент middleware либо обработает запрос сам и прервёт цепочку, либо передаст дальше
Middleware настраиваются и запускаются с помощью методов объекта IApplicationBuilder, который передается в метод Configure из класса Startup.


!!Порядок подключения
Всегда при отладке компонентов нужно иметь в виду правильный порядок их подключения, иначе вы рискуете потратить лишнее время на поиск неочевидных ошибок.


!!Встроенные компоненты
Authentication	app.UseAuthentication(); Поддержка аутентификации.
Cookie Policy	app.UseAuthentication().AddCookies() Отслеживание взаимодействия пользователя с куками.
MVC	app.UseMVC(); Предоставляет функционал ASP.NET MVC.
и так далее...

!!Жизненный цикл
При запуске Core-приложения и создании объекта Startup компоненты Middleware создаются один раз и активны в течение всего жизненного цикла приложения. 

Часто встречающихся методах, вызываемых средой выполнения в классе Startup:

1 Run
2 Use
3 Map
4 